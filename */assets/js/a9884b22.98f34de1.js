"use strict";(self.webpackChunk_taro_hooks_website=self.webpackChunk_taro_hooks_website||[]).push([[1591],{5816:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>p,default:()=>N,frontMatter:()=>d,metadata:()=>u,toc:()=>k});n(79);var a=n(8570),o=n(1285),r=n(9497);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}const d={title:"useFile",nav:{title:"Hooks",path:"/hooks",order:2},group:{title:"\u7f51\u7edc",path:"/network"}},p=void 0,u={unversionedId:"useFile/index",id:"useFile/index",title:"useFile",description:"\u65b0\u7248\u672c\u7684useFile\u65b0\u589e\u4e86\u76f8\u5173\u4e8b\u4ef6\u7684\u53c2\u6570\u914d\u7f6e. \u4f46\u548c\u5c0f\u7a0b\u5e8f\u4e2d\u7684\u4e8b\u4ef6\u7565\u6709\u51fa\u5165. \u7531\u4e8etaro-hooks\u91c7\u7528\u7684\u662fPromise\u7684\u65b9\u5f0f\u7f16\u5199. \u8fd9\u8fb9\u4e8b\u4ef6\u540d\u79f0\u5206\u522b\u89c1",source:"@site/../packages/hooks/src/useFile/index.md",sourceDirName:"useFile",slug:"/useFile/",permalink:"/taro-hooks/hooks/useFile/",draft:!1,editUrl:"https://github.com/innocces/taro-hooks/edit/next/src/../packages/hooks/src/useFile/index.md",tags:[],version:"current",lastUpdatedBy:"innocces",lastUpdatedAt:1693750628,formattedLastUpdatedAt:"2023\u5e749\u67083\u65e5",frontMatter:{title:"useFile",nav:{title:"Hooks",path:"/hooks",order:2},group:{title:"\u7f51\u7edc",path:"/network"}},sidebar:"hooks",previous:{title:"\u7f51\u7edc",permalink:"/taro-hooks/hooks/category/network"},next:{title:"useNetworkType",permalink:"/taro-hooks/hooks/useNetworkType/"}},m={},k=[{value:"\u4f55\u65f6\u4f7f\u7528",id:"\u4f55\u65f6\u4f7f\u7528",level:2},{value:"API",id:"api",level:2},{value:"\u8fd4\u56de\u503c\u8bf4\u660e",id:"\u8fd4\u56de\u503c\u8bf4\u660e",level:2},{value:"DownloadOption",id:"downloadoption",level:3},{value:"UploadOption",id:"uploadoption",level:3},{value:"\u4ee3\u7801\u6f14\u793a",id:"\u4ee3\u7801\u6f14\u793a",level:2},{value:"Hook \u652f\u6301\u5ea6",id:"hook-\u652f\u6301\u5ea6",level:2},{value:"FAQ",id:"faq",level:2}],g={toc:k},c="wrapper";function N(e){var{components:t}=e,n=i(e,["components"]);return(0,a.kt)(c,s(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){l(e,t,n[t])}))}return e}({},g,n),{components:t,mdxType:"MDXLayout"}),(0,a.kt)("admonition",{type:"info"},(0,a.kt)("p",{parentName:"admonition"},"\u65b0\u7248\u672c\u7684",(0,a.kt)("strong",{parentName:"p"},"useFile"),"\u65b0\u589e\u4e86\u76f8\u5173\u4e8b\u4ef6\u7684\u53c2\u6570\u914d\u7f6e. \u4f46\u548c\u5c0f\u7a0b\u5e8f\u4e2d\u7684\u4e8b\u4ef6\u7565\u6709\u51fa\u5165. \u7531\u4e8e",(0,a.kt)("strong",{parentName:"p"},"taro-hooks"),"\u91c7\u7528\u7684\u662f",(0,a.kt)("strong",{parentName:"p"},"Promise"),"\u7684\u65b9\u5f0f\u7f16\u5199. \u8fd9\u8fb9\u4e8b\u4ef6\u540d\u79f0\u5206\u522b",(0,a.kt)("a",{parentName:"p",href:"https://github.com/NervJS/taro/issues/509#issuecomment-415254183"},"\u89c1"))),(0,a.kt)("h1",{id:"usefile"},"useFile"),(0,a.kt)("p",null,"\u4e0a\u4f20\u3001\u4e0b\u8f7d\u6587\u4ef6"),(0,a.kt)("h2",{id:"\u4f55\u65f6\u4f7f\u7528"},"\u4f55\u65f6\u4f7f\u7528"),(0,a.kt)("p",null,"\u5f53\u9700\u8981\u4e0a\u4f20\u4e0b\u8f7d\u6587\u4ef6\u65f6"),(0,a.kt)("h2",{id:"api"},"API"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-jsx"},"const { download, upload } = useFile();\n")),(0,a.kt)("h2",{id:"\u8fd4\u56de\u503c\u8bf4\u660e"},"\u8fd4\u56de\u503c\u8bf4\u660e"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u8fd4\u56de\u503c"),(0,a.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"),(0,a.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"download"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4e0b\u8f7d\u6587\u4ef6"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"PromiseAction<DownloadOption, Taro.downloadFile.FileSuccessCallbackResult>"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"upload"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4e0a\u4f20\u6587\u4ef6"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"PromiseAction<UploadOption, Taro.uploadFile.SuccessCallbackResult>"))))),(0,a.kt)("h3",{id:"downloadoption"},"DownloadOption"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u53c2\u6570"),(0,a.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"),(0,a.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,a.kt)("th",{parentName:"tr",align:null},"\u9ed8\u8ba4\u503c"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"url"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4e0b\u8f7d\u8d44\u6e90\u7684 url"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"string")),(0,a.kt)("td",{parentName:"tr",align:null},"-")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"filePath"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6307\u5b9a\u6587\u4ef6\u4e0b\u8f7d\u540e\u5b58\u50a8\u7684\u8def\u5f84"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"string")),(0,a.kt)("td",{parentName:"tr",align:null},"-")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"header"),(0,a.kt)("td",{parentName:"tr",align:null},"HTTP \u8bf7\u6c42\u7684 Header\uff0cHeader \u4e2d\u4e0d\u80fd\u8bbe\u7f6e Referer"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"TaroGeneral.IAnyObject")),(0,a.kt)("td",{parentName:"tr",align:null},"-")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"progress"),(0,a.kt)("td",{parentName:"tr",align:null},"\u76d1\u542c\u4e0b\u8f7d\u8fdb\u5ea6\u53d8\u5316\u4e8b\u4ef6"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"DownloadTask['onProgressUpdate']")),(0,a.kt)("td",{parentName:"tr",align:null},"-")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"headersReceive"),(0,a.kt)("td",{parentName:"tr",align:null},"\u76d1\u542c HTTP Response Header \u4e8b\u4ef6\u3002\u4f1a\u6bd4\u8bf7\u6c42\u5b8c\u6210\u4e8b\u4ef6\u66f4\u65e9"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"DownloadTask['onHeadersReceived']")),(0,a.kt)("td",{parentName:"tr",align:null},"-")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"afterSend"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5b9e\u4f8b\u540e\u6302\u8f7d\u5bf9\u5e94\u76d1\u542c\u65b9\u6cd5"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"(task: DownloadTask.DownloadTaskPromise) => void")),(0,a.kt)("td",{parentName:"tr",align:null},"-")))),(0,a.kt)("h3",{id:"uploadoption"},"UploadOption"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"\u53c2\u6570"),(0,a.kt)("th",{parentName:"tr",align:null},"\u8bf4\u660e"),(0,a.kt)("th",{parentName:"tr",align:null},"\u7c7b\u578b"),(0,a.kt)("th",{parentName:"tr",align:null},"\u9ed8\u8ba4\u503c"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"url"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5f00\u53d1\u8005\u670d\u52a1\u5668\u5730\u5740"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"string")),(0,a.kt)("td",{parentName:"tr",align:null},"-")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"filePath"),(0,a.kt)("td",{parentName:"tr",align:null},"\u8981\u4e0a\u4f20\u6587\u4ef6\u8d44\u6e90\u7684\u8def\u5f84"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"string")),(0,a.kt)("td",{parentName:"tr",align:null},"-")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"name"),(0,a.kt)("td",{parentName:"tr",align:null},"\u6587\u4ef6\u5bf9\u5e94\u7684 key\uff0c\u5f00\u53d1\u8005\u5728\u670d\u52a1\u7aef\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a key \u83b7\u53d6\u6587\u4ef6\u7684\u4e8c\u8fdb\u5236\u5185\u5bb9"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"string")),(0,a.kt)("td",{parentName:"tr",align:null},"-")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"formData"),(0,a.kt)("td",{parentName:"tr",align:null},"HTTP \u8bf7\u6c42\u4e2d\u5176\u4ed6\u989d\u5916\u7684 form data"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"TaroGeneral.IAnyObject")),(0,a.kt)("td",{parentName:"tr",align:null},"-")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"timeout"),(0,a.kt)("td",{parentName:"tr",align:null},"\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u4e3a\u6beb\u79d2"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"number")),(0,a.kt)("td",{parentName:"tr",align:null},"-")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"header"),(0,a.kt)("td",{parentName:"tr",align:null},"HTTP \u8bf7\u6c42\u7684 Header\uff0cHeader \u4e2d\u4e0d\u80fd\u8bbe\u7f6e Referer"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"TaroGeneral.IAnyObject")),(0,a.kt)("td",{parentName:"tr",align:null},"-")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"fileName"),(0,a.kt)("td",{parentName:"tr",align:null},"\u4e0a\u4f20\u7684\u6587\u4ef6\u540d, API \u652f\u6301\u5ea6: h5"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"string")),(0,a.kt)("td",{parentName:"tr",align:null},"-")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"progress"),(0,a.kt)("td",{parentName:"tr",align:null},"\u76d1\u542c\u4e0b\u8f7d\u8fdb\u5ea6\u53d8\u5316\u4e8b\u4ef6"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"UploadTask['onProgressUpdate']")),(0,a.kt)("td",{parentName:"tr",align:null},"-")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"headersReceive"),(0,a.kt)("td",{parentName:"tr",align:null},"\u76d1\u542c HTTP Response Header \u4e8b\u4ef6\u3002\u4f1a\u6bd4\u8bf7\u6c42\u5b8c\u6210\u4e8b\u4ef6\u66f4\u65e9"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"UploadTask['onHeadersReceived']")),(0,a.kt)("td",{parentName:"tr",align:null},"-")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"afterSend"),(0,a.kt)("td",{parentName:"tr",align:null},"\u5b9e\u4f8b\u540e\u6302\u8f7d\u5bf9\u5e94\u76d1\u542c\u65b9\u6cd5"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("inlineCode",{parentName:"td"},"(task: UploadTask.UploadTaskPromise) => void")),(0,a.kt)("td",{parentName:"tr",align:null},"-")))),(0,a.kt)("h2",{id:"\u4ee3\u7801\u6f14\u793a"},"\u4ee3\u7801\u6f14\u793a"),(0,a.kt)(r.ZP,{VueTab:(0,a.kt)(o.Z,{language:"html",title:"network/useFile/index",openUrl:"https://github.com/innocces/taro-hooks/edit/next/examples/taro-hooks-plugin-vue/src/pages/network/useFile/index.vue",url:"https://innocces.github.io/taro-hooks/vue/pages/network/useFile/index",mdxType:"CodeDisplay"},'<template>\n  <demo-content>\n    <nut-cell title="\u4e0a\u4f20">\n      <template v-slot:link>\n        <nut-button @click="handleUpload()">\u70b9\u51fb</nut-button>\n      </template>\n    </nut-cell>\n    <nut-progress :percentage="uploadProgress" />\n    <nut-input\n      label="\u5730\u5740"\n      placeholder="\u8bf7\u8f93\u5165\u4e0b\u8f7d\u5730\u5740"\n      v-model="downloadFile"\n      @update:model-value="setDownloadFile($event)"\n    />\n    <nut-cell title="\u4e0b\u8f7d">\n      <template v-slot:link>\n        <nut-button :loading="loading" @click="handleDownload()"\n          >\u70b9\u51fb</nut-button\n        >\n      </template>\n    </nut-cell>\n    <nut-progress :percentage="downloadProgress" />\n  </demo-content>\n</template>\n\n<script setup lang="ts">\nimport { showToast, showModal, chooseVideo } from \'@tarojs/taro\';\nimport { useState } from \'@taro-hooks/core\';\nimport { escapeState, log, logError } from \'@taro-hooks/shared\';\nimport { useFile } from \'taro-hooks\';\n\nconst [loading, setLoading] = useState<boolean>(false);\nconst [uploadProgress, setUploadProgress] = useState<number>(0);\nconst [downloadFile, setDownloadFile] = useState<string>(\n  \'https://storage.360buyimg.com/nutui/video/video_NutUI.mp4\',\n);\nconst [downloadProgress, setDownloadProgress] = useState<number>(0);\n\nconst { download, upload } = useFile();\n\nconst onProgress = (\n  { progress = 0, totalBytesSent = 0, totalBytesExpectedToSend = 0 } = {},\n  action,\n) => {\n  action(progress);\n  showToast({\n    title: \'${progress}%: ${totalBytesSent} / ${totalBytesExpectedToSend}\',\n    icon: \'loading\',\n    mask: true,\n  });\n};\n\nconst onHeadersReceived = (headers) => {\n  log(headers);\n  showToast({\n    title: \'onHeadersReceived trigger\',\n    icon: \'none\',\n    mask: true,\n  });\n};\n\nconst handleDownload = async () => {\n  if (!escapeState(downloadFile)?.length) return;\n  const downloadUpdate = (progressResult) =>\n    onProgress(progressResult, setDownloadProgress);\n  const option = {\n    progress: downloadUpdate,\n    headersReceive: onHeadersReceived,\n    url: escapeState(downloadFile),\n  };\n  setLoading(true);\n  setDownloadProgress(0);\n  try {\n    const response = await download(option);\n    showModal({\n      title: \'\u4e0b\u8f7d\u6210\u529f\',\n      content: response?.tempFilePath,\n      showCancel: false,\n    });\n  } catch (e) {\n    logError(e.message);\n  }\n  setLoading(false);\n};\n\nconst handleUpload = async () => {\n  try {\n    const videos = await chooseVideo({});\n    if (videos?.tempFilePath) {\n      setUploadProgress(0);\n      setLoading(true);\n      const uploadUpdate = (progressResult) =>\n        onProgress(progressResult, setUploadProgress);\n      const option = {\n        progress: uploadUpdate,\n        headersReceive: onHeadersReceived,\n        filePath: videos.tempFilePath,\n      };\n      const response = await upload(option);\n      showModal({\n        title: \'\u4e0a\u4f20\u6210\u529f\',\n        content: response?.data,\n        showCancel: false,\n      });\n    }\n  } catch (e) {\n    logError(e.message);\n  }\n  setLoading(false);\n};\n<\/script>\n'),ReactTab:(0,a.kt)(o.Z,{language:"tsx",title:"network/useFile/index",openUrl:"https://github.com/innocces/taro-hooks/edit/next/examples/taro-hooks-plugin/src/pages/network/useFile/index.tsx",url:"https://innocces.github.io/taro-hooks/react/pages/network/useFile/index",mdxType:"CodeDisplay"},"import React from 'react';\nimport { showToast, showModal, chooseVideo } from '@tarojs/taro';\nimport { useState } from '@taro-hooks/core';\nimport { log, logError } from '@taro-hooks/shared';\nimport { useFile } from 'taro-hooks';\nimport DemoContent from '@src/components/DemoContent';\nimport { Cell, Button, Progress, Input, Field } from '@taroify/core';\n\nexport default () => {\n  const [loading, setLoading] = useState<boolean>(false);\n  const [uploadProgress, setUploadProgress] = useState<number>(0);\n  const [downloadFile, setDownloadFile] = useState<string>(\n    'https://storage.360buyimg.com/nutui/video/video_NutUI.mp4',\n  );\n  const [downloadProgress, setDownloadProgress] = useState<number>(0);\n\n  const { download, upload } = useFile();\n\n  const onProgress = (\n    { progress = 0, totalBytesSent = 0, totalBytesExpectedToSend = 0 } = {},\n    action,\n  ) => {\n    action(progress);\n    showToast({\n      title: '${progress}%: ${totalBytesSent} / ${totalBytesExpectedToSend}',\n      icon: 'loading',\n      mask: true,\n    });\n  };\n\n  const onHeadersReceived = (headers) => {\n    log(headers);\n    showToast({\n      title: 'onHeadersReceived trigger',\n      icon: 'none',\n      mask: true,\n    });\n  };\n\n  const handleDownload = async () => {\n    if (!downloadFile?.length) return;\n    const downloadUpdate = (progressResult) =>\n      onProgress(progressResult, setDownloadProgress);\n    const option = {\n      progress: downloadUpdate,\n      headersReceive: onHeadersReceived,\n      url: downloadFile,\n    };\n    setLoading(true);\n    setDownloadProgress(0);\n    try {\n      const response = await download(option);\n      showModal({\n        title: '\u4e0b\u8f7d\u6210\u529f',\n        content: response?.tempFilePath,\n        showCancel: false,\n      });\n    } catch (e) {\n      logError(e.message);\n    }\n    setLoading(false);\n  };\n\n  const handleUpload = async () => {\n    try {\n      const videos = await chooseVideo({});\n      if (videos?.tempFilePath) {\n        setUploadProgress(0);\n        setLoading(true);\n        const uploadUpdate = (progressResult) =>\n          onProgress(progressResult, setUploadProgress);\n        const option = {\n          progress: uploadUpdate,\n          headersReceive: onHeadersReceived,\n          filePath: videos.tempFilePath,\n        };\n        const response = await upload(option);\n        showModal({\n          title: '\u4e0a\u4f20\u6210\u529f',\n          content: response?.data,\n          showCancel: false,\n        });\n      }\n    } catch (e) {\n      logError(e.message);\n    }\n    setLoading(false);\n  };\n\n  return (\n    <DemoContent>\n      <Cell title=\"\u4e0a\u4f20\" clickable>\n        <Button loading={loading} onClick={handleUpload}>\n          \u70b9\u51fb\n        </Button>\n      </Cell>\n      <Progress percent={uploadProgress} />\n      <Field label=\"\u5730\u5740\">\n        <Input\n          value={downloadFile}\n          onChange={(event) => setDownloadFile(event.detail.value)}\n          placeholder=\"\u8bf7\u8f93\u5165\u4e0b\u8f7d\u5730\u5740\"\n        />\n      </Field>\n      <Cell title=\"\u4e0b\u8f7d\" clickable>\n        <Button loading={loading} onClick={handleDownload}>\n          \u70b9\u51fb\n        </Button>\n      </Cell>\n      <Progress percent={downloadProgress} />\n    </DemoContent>\n  );\n};\n"),mdxType:"CombineTabs"}),(0,a.kt)("h2",{id:"hook-\u652f\u6301\u5ea6"},"Hook \u652f\u6301\u5ea6"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:"center"},"\u5fae\u4fe1\u5c0f\u7a0b\u5e8f"),(0,a.kt)("th",{parentName:"tr",align:"center"},"H5"),(0,a.kt)("th",{parentName:"tr",align:"center"},"ReactNative"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f"),(0,a.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f"),(0,a.kt)("td",{parentName:"tr",align:"center"},"\u2714\ufe0f")))),(0,a.kt)("h2",{id:"faq"},"FAQ"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},(0,a.kt)("p",{parentName:"li"},"\u5982\u4f55",(0,a.kt)("strong",{parentName:"p"},"abort"),"\u4e0b\u8f7d\u6216\u4e0a\u4f20?"),(0,a.kt)("p",{parentName:"li"},"\u53ef\u4ee5\u4f7f\u7528",(0,a.kt)("strong",{parentName:"p"},"afterSend"),"\u76d1\u542c\u65b9\u6cd5\u83b7\u53d6\u5230",(0,a.kt)("strong",{parentName:"p"},"xxxTask.xxxTaskPromise"),"."),(0,a.kt)("pre",{parentName:"li"},(0,a.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"showLineNumbers",showLineNumbers:!0},"import { useRef } from '@tarojs/taro';\n\nconst task = useRef<UploadTask.UploadTaskPromise>();\n\nconst afterSend = (concurrentTask) => (task.current = concurrentTask);\n\n// then\n\ntask.current.abort();\n")))))}N.isMDXComponent=!0}}]);